world.config
{'train_batch': 2048, 'n_layers': 1, 'latent_dim_rec': 32, 'enable_dropout': 0, 'keep_prob': 0.6, 'test_u_batch_size': 2048, 'multicore': 0, 'loss': 'bpr', 'lr': 0.1, 'weight_decay': 1e-06, 'pretrain': 0, 'enable_DRO': 1, 'alpha': 0.1, 'tau': 1.0, 'norm_emb': 0, 'full_batch': True, 'num_negtive_items': 1, 'ood': 'popularity_shift', 'cuda': '0', 'aug_on': True, 'aug_ratio': 0.01, 'aug_coefficient': 0.1, 'aug_warm_up': 5, 'aug_gap': 5, 'ssm_temp': 0.1, 'enable_vat': True, 'vat_eps': 1.0, 'vat_xi': 1e-06, 'vat_ip': 1, 'vat_coeff': 0.1, 'vat_temp': 1.0}
============================================
[0;30;43m[TEST][0m
{'precision': array([0.00016913]), 'recall': array([0.0004784]), 'ndcg': array([0.00032327]), 'hitratio': array([0.00046492])}
EPOCH[1/50] Loss0.695-Time4.1199493408203125
EPOCH[2/50] Loss0.682-Time3.205784320831299
EPOCH[3/50] Loss0.617-Time3.1787960529327393
EPOCH[4/50] Loss0.485-Time3.5100882053375244
EPOCH[5/50] Loss0.340-Time3.4476630687713623
[0;30;43m[TEST][0m
{'precision': array([0.00674024]), 'recall': array([0.01624271]), 'ndcg': array([0.01495619]), 'hitratio': array([0.01852772])}
=====Aug_edges begin=====
  0%|                                                                         | 0/15 [00:00<?, ?it/s] 47%|##############################3                                  | 7/15 [00:00<00:00, 60.28it/s] 93%|###########################################################7    | 14/15 [00:00<00:00, 59.14it/s]100%|################################################################| 15/15 [00:00<00:00, 60.40it/s]
New add edges num:  30144
Aug_edges time:  2.8286614418029785
======Aug_edges done!======
EPOCH[6/50] Loss0.236-Time6.608081102371216
EPOCH[7/50] Loss0.183-Time3.7478373050689697
EPOCH[8/50] Loss0.157-Time3.5577392578125
EPOCH[9/50] Loss0.143-Time3.4528112411499023
EPOCH[10/50] Loss0.135-Time3.372375011444092
[0;30;43m[TEST][0m
{'precision': array([0.00633331]), 'recall': array([0.01681118]), 'ndcg': array([0.01311306]), 'hitratio': array([0.01740916])}
=====Aug_edges begin=====
  0%|                                                                         | 0/15 [00:00<?, ?it/s] 47%|##############################3                                  | 7/15 [00:00<00:00, 59.31it/s] 93%|###########################################################7    | 14/15 [00:00<00:00, 60.72it/s]100%|################################################################| 15/15 [00:00<00:00, 60.75it/s]
New add edges num:  30144
Aug_edges time:  3.2161905765533447
======Aug_edges done!======
EPOCH[11/50] Loss0.131-Time7.11900782585144
EPOCH[12/50] Loss0.128-Time3.602480888366699
EPOCH[13/50] Loss0.124-Time3.5906946659088135
EPOCH[14/50] Loss0.122-Time3.2480733394622803
EPOCH[15/50] Loss0.114-Time3.257452964782715
[0;30;43m[TEST][0m
{'precision': array([0.00469221]), 'recall': array([0.01334083]), 'ndcg': array([0.00901916]), 'hitratio': array([0.01289806])}
=====Aug_edges begin=====
  0%|                                                                         | 0/15 [00:00<?, ?it/s] 40%|##########################                                       | 6/15 [00:00<00:00, 57.39it/s] 80%|###################################################2            | 12/15 [00:00<00:00, 54.64it/s]100%|################################################################| 15/15 [00:00<00:00, 56.92it/s]
New add edges num:  30144
Aug_edges time:  2.7721102237701416
======Aug_edges done!======
EPOCH[16/50] Loss0.113-Time6.274980783462524
EPOCH[17/50] Loss0.109-Time3.338909864425659
EPOCH[18/50] Loss0.107-Time3.450726270675659
EPOCH[19/50] Loss0.104-Time3.4212207794189453
EPOCH[20/50] Loss0.100-Time3.7168121337890625
[0;30;43m[TEST][0m
{'precision': array([0.00397548]), 'recall': array([0.01130918]), 'ndcg': array([0.00757588]), 'hitratio': array([0.01092791])}
=====Aug_edges begin=====
  0%|                                                                         | 0/15 [00:00<?, ?it/s] 40%|##########################                                       | 6/15 [00:00<00:00, 58.60it/s] 87%|#######################################################4        | 13/15 [00:00<00:00, 60.38it/s]100%|################################################################| 15/15 [00:00<00:00, 61.30it/s]
New add edges num:  30144
Aug_edges time:  2.7606935501098633
======Aug_edges done!======
EPOCH[21/50] Loss0.098-Time6.365102767944336
EPOCH[22/50] Loss0.095-Time3.5266873836517334
EPOCH[23/50] Loss0.093-Time3.7158899307250977
EPOCH[24/50] Loss0.089-Time3.7443816661834717
EPOCH[25/50] Loss0.087-Time3.649376153945923
[0;30;43m[TEST][0m
{'precision': array([0.00374104]), 'recall': array([0.01080317]), 'ndcg': array([0.00730417]), 'hitratio': array([0.01028346])}
=====Aug_edges begin=====
  0%|                                                                         | 0/15 [00:00<?, ?it/s] 40%|##########################                                       | 6/15 [00:00<00:00, 56.05it/s] 80%|###################################################2            | 12/15 [00:00<00:00, 57.59it/s]100%|################################################################| 15/15 [00:00<00:00, 58.67it/s]
New add edges num:  30144
Aug_edges time:  2.750688076019287
======Aug_edges done!======
EPOCH[26/50] Loss0.085-Time6.372559547424316
EPOCH[27/50] Loss0.084-Time3.4324886798858643
EPOCH[28/50] Loss0.081-Time3.448662519454956
EPOCH[29/50] Loss0.080-Time3.6556692123413086
EPOCH[30/50] Loss0.077-Time3.498910665512085
[0;30;43m[TEST][0m
{'precision': array([0.0034999]), 'recall': array([0.01007293]), 'ndcg': array([0.00687552]), 'hitratio': array([0.00962061])}
best_hit: 0.018527724841421088, best_ndcg: 0.014956192542039105, best_precision: 0.006740237122379263, best_recall: 0.01681117972644541
